{{ define "main" }}
<section class="page-section">
    <div class="page-container">
        <h1 class="text-3xl font-serif text-center">{{ .Title }}</h1>
        <p class="text-lg text-gray-600 text-center">{{ .Content }}</p>

        <div class="flex justify-center mb-5">
            <a href="{{ absURL "admin/#/collections/weekly_plans/new" }}"
                class="btn btn-primary btn-md">
                <i class="fas fa-plus"></i>
                <span>Stwórz nowy plan</span>
            </a>
        </div>

        {{ if .Pages }}
        <div class="plan-grid">
            {{ range .Pages.ByDate.Reverse }}
            <div>
                <div class="card bg-base-100 shadow-md hover:shadow-xl rounded-2xl overflow-hidden transition-all duration-200 hover:-translate-y-1">
                    <div class="card-header bg-base-200 p-4 flex items-center justify-between border-b border-base-300">
                        <p class="card-header-title font-heading font-semibold text-lg m-0">
                            <a href="{{ .Permalink }}" class="text-inherit hover:text-primary">{{ .Title }}</a>
                        </p>
                        <div>
                            {{ if .Params.start_date }}
                            <span class="badge badge-info badge-lg">{{ .Params.start_date | time.Format "02.01" }}</span>
                            {{ end }}
                        </div>
                    </div>
                    <div class="card-body p-4">
                        <div class="content">
                            <p class="text-base-content/70 flex items-center gap-2">
                                <i class="far fa-calendar"></i>
                                Tydzień {{ .Params.week_number }}/{{ .Params.year }}
                            </p>
                            {{ if .Params.notes }}
                            <p class="mt-2">{{ .Params.notes | truncate 100 }}</p>
                            {{ end }}
                        </div>
                    </div>
                    <div class="card-footer border-t border-base-300 flex">
                        <a href="{{ .Permalink }}" class="flex-1 flex items-center justify-center gap-2 p-3 hover:bg-base-200 transition-colors border-r border-base-300">
                            <i class="fas fa-eye"></i>
                            <span>Zobacz</span>
                        </a>
                        {{- $planSlug := urlquery .File.BaseFileName -}}
                        {{- $planSlug = replace $planSlug "+" "%20" -}}
                        <a href="{{ absURL (printf "admin/#/collections/weekly_plans/entries/%s" $planSlug) }}"
                            class="flex-1 flex items-center justify-center gap-2 p-3 hover:bg-base-200 transition-colors">
                            <i class="fas fa-edit"></i>
                            <span>Edytuj</span>
                        </a>
                    </div>
                </div>
            </div>
            {{ end }}
        </div>
        {{ else }}
        <div class="alert alert-info">
            <div class="text-center w-full">
                <p class="mb-2">
                    <span class="text-4xl"><i class="fas fa-calendar-alt"></i></span>
                </p>
                <p>
                    Nie masz jeszcze żadnych planów tygodniowych. Kliknij przycisk wyżej, aby stworzyć pierwszy!
                </p>
            </div>
        </div>
        {{ end }}
    </div>
</section>
{{ end }}