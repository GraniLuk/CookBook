{{ define "main" }}
<!-- DEBUG: Używamy szablonu taxonomy/list.html -->
<!-- DEBUG: Title = {{ .Title }}, Type = {{ .Type }}, Kind = {{ .Kind }} -->
<div class="section">
    <div class="container">
        {{ if eq .Title "low-fodmap" }}
        {{/* Specjalna strona dla Low FODMAP - pokazuje tylko przepisy z fodmap.status = "yes" */}}
        <h1 class="title"><i class="fas fa-leaf has-text-success"></i> Low FODMAP - Bezpieczne Przepisy</h1>
        <p class="subtitle">
            Przepisy oznaczone jako w pełni bezpieczne dla diety Low FODMAP
        </p>

        <div class="notification is-info is-light mb-5">
            <p><strong>Co to oznacza?</strong> Te przepisy zawierają tylko składniki o niskiej zawartości FODMAP i można
                je spożywać bez ograniczeń w normalnych porcjach.</p>
        </div>

        {{/* Filtruj wszystkie strony w site - tylko te z fodmap.status = "yes" */}}
        {{ $safePages := where site.RegularPages ".Params.fodmap.status" "yes" }}

        <p class="has-text-grey mb-4">
            <i class="fas fa-check-circle has-text-success"></i>
            {{ len $safePages }} {{ if eq (len $safePages) 1 }}bezpieczny przepis{{ else }}bezpiecznych przepisów{{ end
            }}
        </p>

        <div class="columns is-multiline">
            {{ partial "sorted-recipes.html" (dict "pages" $safePages "template" "recipe-card-safe.html" "columnClass" "is-4") }}
        </div>

        {{/* Dodaj sekcję z przepisami "depends" */}}
        {{ $dependsPages := where site.RegularPages ".Params.fodmap.status" "depends" }}
        {{ if gt (len $dependsPages) 0 }}
        <hr class="my-6">
        <h2 class="title is-4"><i class="fas fa-exclamation-triangle has-text-warning"></i> Przepisy z ograniczeniami
        </h2>
        <p class="subtitle">
            Przepisy, które można dostosować do diety Low FODMAP
        </p>

        <div class="notification is-warning is-light">
            <p><strong>Uwaga:</strong> Te przepisy wymagają modyfikacji składników lub ograniczeń porcji. Każdy przepis
                zawiera szczegółowe instrukcje jak je dostosować do diety Low FODMAP.</p>
        </div>

        <div class="columns is-multiline">
            {{ partial "sorted-recipes.html" (dict "pages" $dependsPages "template" "recipe-card-depends.html" "columnClass" "is-4") }}
        </div>
        {{ end }}

        {{ else }}
        <h1 class="title">{{ .Title }}</h1>
        <p class="subtitle">{{ len .Pages }} {{ if eq (len .Pages) 1 }}przepis{{ else }}przepisów{{ end }} w kategorii
            "{{ .Title }}"</p>

        <div class="columns is-multiline">
            {{ partial "sorted-recipes.html" (dict "pages" .Pages "template" "recipe-card-regular.html" "columnClass" "is-4") }}
        </div>
        {{ end }}
    </div>
</div>
{{ end }}